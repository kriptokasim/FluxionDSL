# Vars: oast (Ã¶rn: d42...oast.me), token
let oast_domain = oast ?? env_OAST ?? "example.oast.me"
let beacon_token = token ?? "0"
let beacon_path = "/fluxion/check"

# DNS + HTTP beacon
let b = oast_beacon sub=beacon_token domain=oast_domain path=beacon_path q={ tool: "fluxion", token: beacon_token }

echo value=jsonify({
  token: beacon_token,
  url: (b?.url ?? ""),
  status: (b?.status ?? 0),
  ok: (b?.ok ?? false),
  error: (b?.error ?? null)
})

return 200
